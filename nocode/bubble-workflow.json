{
  "name": "PawfectSitters Bubble Workflow",
  "description": "No-code workflow automation for PawfectSitters using Bubble.io",
  "version": "1.0.0",
  "platform": "Bubble.io",
  "app_name": "PawfectSitters",
  "workflows": [
    {
      "name": "New User Registration",
      "description": "Automated workflow for new user registration",
      "trigger": {
        "type": "user_signup",
        "conditions": [
          {
            "field": "User Role",
            "operator": "is_not_empty"
          }
        ]
      },
      "actions": [
        {
          "name": "Send Welcome Email",
          "type": "send_email",
          "template": "welcome_email",
          "recipient": "{{User.Email}}",
          "subject": "Welcome to PawfectSitters!",
          "delay": 0
        },
        {
          "name": "Create User Profile",
          "type": "create_thing",
          "data_type": "User Profile",
          "fields": {
            "User": "{{User}}",
            "Profile Status": "Incomplete",
            "Verification Status": "Pending",
            "Created Date": "{{Current Date}}"
          }
        },
        {
          "name": "Send Admin Notification",
          "type": "send_email",
          "template": "admin_new_user",
          "recipient": "admin@pawfectsitters.com",
          "subject": "New User Registration: {{User.Email}}",
          "delay": 0
        }
      ]
    },
    {
      "name": "Booking Confirmation",
      "description": "Workflow for booking confirmation and notifications",
      "trigger": {
        "type": "thing_changed",
        "data_type": "Booking",
        "conditions": [
          {
            "field": "Status",
            "operator": "equals",
            "value": "Confirmed"
          }
        ]
      },
      "actions": [
        {
          "name": "Send Owner Confirmation",
          "type": "send_email",
          "template": "booking_confirmation",
          "recipient": "{{Booking.Owner.Email}}",
          "subject": "Booking Confirmed - {{Booking.Pet.Name}}",
          "delay": 0
        },
        {
          "name": "Notify Sitter",
          "type": "send_email",
          "template": "sitter_booking_confirmed",
          "recipient": "{{Booking.Sitter.Email}}",
          "subject": "New Booking Confirmed",
          "delay": 0
        },
        {
          "name": "Create Calendar Event",
          "type": "google_calendar",
          "action": "create_event",
          "calendar_id": "{{Booking.Sitter.Calendar ID}}",
          "event_details": {
            "summary": "Pet Sitting: {{Booking.Pet.Name}}",
            "description": "Pet sitting session for {{Booking.Pet.Name}} at {{Booking.Location}}",
            "start_time": "{{Booking.Start Date}}",
            "end_time": "{{Booking.End Date}}",
            "location": "{{Booking.Location}}"
          }
        },
        {
          "name": "Update Booking Status",
          "type": "update_thing",
          "data_type": "Booking",
          "thing": "{{Booking}}",
          "fields": {
            "Confirmation Date": "{{Current Date}}",
            "Last Updated": "{{Current Date}}"
          }
        }
      ]
    },
    {
      "name": "Payment Processing",
      "description": "Handle payment processing and status updates",
      "trigger": {
        "type": "stripe_webhook",
        "event": "payment_intent.succeeded"
      },
      "actions": [
        {
          "name": "Update Booking Payment",
          "type": "update_thing",
          "data_type": "Booking",
          "thing": "{{Booking}}",
          "fields": {
            "Payment Status": "Paid",
            "Payment Date": "{{Current Date}}",
            "Stripe Payment Intent": "{{Stripe Payment Intent ID}}"
          }
        },
        {
          "name": "Create Payment Record",
          "type": "create_thing",
          "data_type": "Payment",
          "fields": {
            "Booking": "{{Booking}}",
            "Amount": "{{Stripe Amount}}",
            "Currency": "{{Stripe Currency}}",
            "Status": "Completed",
            "Payment Method": "{{Stripe Payment Method}}",
            "Transaction Date": "{{Current Date}}"
          }
        },
        {
          "name": "Send Payment Receipt",
          "type": "send_email",
          "template": "payment_receipt",
          "recipient": "{{Booking.Owner.Email}}",
          "subject": "Payment Confirmed - Receipt",
          "delay": 0
        }
      ]
    },
    {
      "name": "Session Start Reminder",
      "description": "Send reminders before pet sitting sessions",
      "trigger": {
        "type": "scheduled",
        "schedule": "1 hour before booking start",
        "data_type": "Booking",
        "conditions": [
          {
            "field": "Status",
            "operator": "equals",
            "value": "Confirmed"
          }
        ]
      },
      "actions": [
        {
          "name": "Send Owner Reminder",
          "type": "send_email",
          "template": "session_reminder_owner",
          "recipient": "{{Booking.Owner.Email}}",
          "subject": "Pet Sitting Session Starting Soon",
          "delay": 0
        },
        {
          "name": "Send Sitter Reminder",
          "type": "send_email",
          "template": "session_reminder_sitter",
          "recipient": "{{Booking.Sitter.Email}}",
          "subject": "Pet Sitting Session Starting Soon",
          "delay": 0
        },
        {
          "name": "Send Push Notification",
          "type": "push_notification",
          "recipient": "{{Booking.Sitter}}",
          "title": "Session Starting Soon",
          "message": "Your pet sitting session for {{Booking.Pet.Name}} starts in 1 hour",
          "delay": 0
        }
      ]
    },
    {
      "name": "Review Request",
      "description": "Request reviews after completed sessions",
      "trigger": {
        "type": "scheduled",
        "schedule": "24 hours after booking end",
        "data_type": "Booking",
        "conditions": [
          {
            "field": "Status",
            "operator": "equals",
            "value": "Completed"
          },
          {
            "field": "Review Requested",
            "operator": "equals",
            "value": "No"
          }
        ]
      },
      "actions": [
        {
          "name": "Send Review Request",
          "type": "send_email",
          "template": "review_request",
          "recipient": "{{Booking.Owner.Email}}",
          "subject": "How was your pet sitting experience?",
          "delay": 0
        },
        {
          "name": "Update Review Status",
          "type": "update_thing",
          "data_type": "Booking",
          "thing": "{{Booking}}",
          "fields": {
            "Review Requested": "Yes",
            "Review Request Date": "{{Current Date}}"
          }
        }
      ]
    },
    {
      "name": "Sitter Verification",
      "description": "Handle sitter verification process",
      "trigger": {
        "type": "thing_changed",
        "data_type": "Sitter Verification",
        "conditions": [
          {
            "field": "Status",
            "operator": "equals",
            "value": "Submitted"
          }
        ]
      },
      "actions": [
        {
          "name": "Send Admin Review Notification",
          "type": "send_email",
          "template": "admin_verification_review",
          "recipient": "admin@pawfectsitters.com",
          "subject": "New Sitter Verification Request",
          "delay": 0
        },
        {
          "name": "Send Sitter Confirmation",
          "type": "send_email",
          "template": "verification_submitted",
          "recipient": "{{Sitter Verification.Sitter.Email}}",
          "subject": "Verification Submitted - Under Review",
          "delay": 0
        }
      ]
    },
    {
      "name": "Emergency Contact",
      "description": "Handle emergency situations during sessions",
      "trigger": {
        "type": "user_action",
        "action": "report_emergency",
        "data_type": "Booking"
      },
      "actions": [
        {
          "name": "Send Emergency Alert",
          "type": "send_email",
          "template": "emergency_alert",
          "recipient": "{{Booking.Owner.Email}}",
          "subject": "URGENT: Emergency During Pet Sitting Session",
          "delay": 0
        },
        {
          "name": "Send SMS Alert",
          "type": "send_sms",
          "recipient": "{{Booking.Owner.Phone}}",
          "message": "URGENT: Emergency during pet sitting session for {{Booking.Pet.Name}}. Please check your email immediately.",
          "delay": 0
        },
        {
          "name": "Notify Admin",
          "type": "send_email",
          "template": "admin_emergency",
          "recipient": "admin@pawfectsitters.com",
          "subject": "EMERGENCY: {{Booking.Pet.Name}} - {{Booking.Sitter.Name}}",
          "delay": 0
        },
        {
          "name": "Create Emergency Record",
          "type": "create_thing",
          "data_type": "Emergency",
          "fields": {
            "Booking": "{{Booking}}",
            "Reported By": "{{Current User}}",
            "Emergency Type": "{{Emergency Type}}",
            "Description": "{{Emergency Description}}",
            "Reported Date": "{{Current Date}}",
            "Status": "Active"
          }
        }
      ]
    }
  ],
  "data_types": {
    "User": {
      "fields": [
        "Email",
        "First Name",
        "Last Name",
        "Phone",
        "Role",
        "Profile Picture",
        "Created Date",
        "Last Login"
      ]
    },
    "Booking": {
      "fields": [
        "Owner",
        "Sitter",
        "Pet",
        "Start Date",
        "End Date",
        "Status",
        "Payment Status",
        "Total Amount",
        "Location",
        "Special Instructions",
        "Created Date",
        "Last Updated"
      ]
    },
    "Pet": {
      "fields": [
        "Owner",
        "Name",
        "Type",
        "Breed",
        "Age",
        "Weight",
        "Special Needs",
        "Photos"
      ]
    },
    "Payment": {
      "fields": [
        "Booking",
        "Amount",
        "Currency",
        "Status",
        "Payment Method",
        "Transaction Date",
        "Stripe Payment Intent"
      ]
    },
    "Review": {
      "fields": [
        "Booking",
        "Reviewer",
        "Reviewed User",
        "Rating",
        "Comment",
        "Review Date"
      ]
    }
  },
  "email_templates": {
    "welcome_email": {
      "subject": "Welcome to PawfectSitters!",
      "body": "Welcome {{User.First Name}}! We're excited to have you join our pet sitting community."
    },
    "booking_confirmation": {
      "subject": "Booking Confirmed - {{Booking.Pet.Name}}",
      "body": "Your booking for {{Booking.Pet.Name}} has been confirmed with {{Booking.Sitter.First Name}}."
    },
    "payment_receipt": {
      "subject": "Payment Confirmed - Receipt",
      "body": "Thank you for your payment of ${{Payment.Amount}} for booking #{{Booking.ID}}."
    }
  },
  "api_integrations": {
    "stripe": {
      "webhook_url": "https://pawfectsitters.bubbleapps.io/version-test/api/1.1/wf/stripe_webhook",
      "events": [
        "payment_intent.succeeded",
        "payment_intent.payment_failed",
        "charge.refunded"
      ]
    },
    "google_calendar": {
      "scope": "https://www.googleapis.com/auth/calendar",
      "permissions": [
        "read",
        "write"
      ]
    },
    "twilio": {
      "account_sid": "{{TWILIO_ACCOUNT_SID}}",
      "auth_token": "{{TWILIO_AUTH_TOKEN}}",
      "phone_number": "{{TWILIO_PHONE_NUMBER}}"
    }
  },
  "settings": {
    "timezone": "UTC",
    "date_format": "MM/DD/YYYY",
    "time_format": "HH:mm",
    "currency": "USD",
    "language": "en"
  }
}
